<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<title>Pomodoro Controlado</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body{font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;background:#0f172a;color:#fff;margin:0;padding:24px;display:flex;justify-content:center}
  .card{max-width:520px;width:100%;background:#0b1220;border:1px solid #223045;border-radius:16px;padding:24px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
  h2{margin:0 0 8px 0}
  .time{font-size:76px;letter-spacing:2px;margin:8px 0 4px 0;text-align:center}
  .status{font-size:14px;color:#aab; text-align:center}
</style>
</head>
<body>
<div class="card">
  <h2>üçÖ Pomodoro</h2>
  <div class="time" id="display">25:00</div>
  <div class="status" id="status">Esperando orden‚Ä¶</div>
</div>

<script>
  // Duraci√≥n de trabajo fija a 25' (ajusta si quieres 30: cambia a 30*60)
  const DURATION = 25 * 60;
  let remaining = DURATION;
  let running = false;
  let timer = null;

  const display = document.getElementById('display');
  const status  = document.getElementById('status');

  function render(){
    const m = Math.floor(remaining/60), s = remaining%60;
    display.textContent = `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  }
  function tick(){
    if (remaining>0){ remaining--; render(); }
    else { stop(); status.textContent = '‚úÖ Completado'; }
  }
  function start(){
    if (running) return;
    running = true;
    status.textContent = '‚ñ∂Ô∏è En marcha';
    timer = setInterval(tick,1000);
  }
  function pause(){
    if (!running) return;
    running = false;
    status.textContent = '‚è∏Ô∏è Pausado';
    clearInterval(timer);
  }
  function stop(){
    running = false;
    clearInterval(timer);
    remaining = DURATION;
    render();
    status.textContent = '‚èπÔ∏è Detenido';
  }

  // üîÑ Polling cada 2s a Make: debe responder JSON { "action": "start|pause|stop" }
  const ENDPOINT = 'https://hook.eu1.make.com/TU_ENDPOINT_DE_LECTURA';
  async function poll(){
    try{
      const res = await fetch(ENDPOINT, { cache:'no-store' });
      if (!res.ok) return;
      const { action } = await res.json();
      if (action === 'start') start();
      if (action === 'pause') pause();
      if (action === 'stop')  stop();
    }catch(e){ /* ignorar errores de red */ }
  }
  setInterval(poll, 2000);
  render();
</script>
</body>
</html>
